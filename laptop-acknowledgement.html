<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laptop Acknowledgement - Chesmi Groups IT</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<form class="a4-page" id="laptopAckForm">
    <header>
        <div class="logo-container">
            <img src="chesmi-logo.png" alt="Chesmi Logo">
        </div>
        <h1>Employee Laptop Acknowledgement Form</h1>
    </header>

    <h2>Employee & Assignment Details</h2>
    <div class="form-group">
        <label for="epfNumber">EPF Number:</label>
        <div class="input-container"><input type="text" id="epfNumber" placeholder="E.g., EPF-00102"></div>
    </div>
    <div class="form-group">
        <label for="employeeName">Employee Name:</label>
        <div class="input-container"><input type="text" id="employeeName" placeholder="E.g., Nimal Fernando"></div>
    </div>
    <div class="form-group">
        <label for="branch">Branch:</label>
        <div class="input-container"><input type="text" id="branch" placeholder="E.g., Head Office"></div>
    </div>
    <div class="form-group">
        <label for="department">Department:</label>
        <div class="input-container"><input type="text" id="department" placeholder="E.g., Sales"></div>
    </div>
    <div class="form-group">
        <label for="designation">Designation:</label>
        <div class="input-container"><input type="text" id="designation" placeholder="E.g., Sales Manager"></div>
    </div>

    <h2>Laptop Details (Assigned IT Resource)</h2>
    <div class="form-group">
        <label for="laptopModel">Model:</label>
        <div class="input-container"><input type="text" id="laptopModel" placeholder="E.g., Dell Latitude 5420" required></div>
    </div>
    <div class="form-group">
        <label for="serialNumber">Serial Number:</label>
        <div class="input-container"><input type="text" id="serialNumber" placeholder="E.g., ABC-7362-XYZ" required></div>
    </div>

    <h3>Laptop Specification <span style="font-weight:400; font-size: 0.8em;">(Filled By IT Department)</span></h3>
    <table style="width: 80%;" class="spec-table">
        <tr><th style="width: 30%;">Item</th><th>Current Status/Spec</th></tr>
        <tr><td>Processor</td><td><input type="text" name="specProcessor" placeholder="E.g., Core i7 11th Gen"></td></tr>
        <tr><td>RAM</td><td><input type="text" name="specRAM" placeholder="E.g., 16GB DDR4"></td></tr>
        <tr><td>ROM/HDD</td><td><input type="text" name="specROM" placeholder="E.g., 512GB NVMe SSD"></td></tr>
        <tr><td>OS</td><td><input type="text" name="specOS" placeholder="E.g., Windows 10 Pro"></td></tr>
        <tr><td>Laptop charger</td><td><input type="text" name="specCharger" placeholder="E.g., Yes / P/N: 45W-CHG"></td></tr>
        <tr><td>Laptop Bag Status</td><td><input type="text" name="specBag" placeholder="E.g., NEW / OLD / N/A"></td></tr>
        <tr><td colspan="2" style="font-size: 0.9em; border-top: 1px solid #ccc; padding-top: 10px;">
            Inventory Update Date: <div class="input-container" style="display: inline-block; width: 150px;"><input type="date" name="inventoryDate"></div> | 
            Updated By: <div class="input-container" style="display: inline-block; width: 150px;"><input type="text" name="inventoryUpdater" placeholder="IT Staff Name"></div>
        </td></tr>
    </table>

    <h2>User Acknowledgement <span style="font-weight:400; font-size: 0.8em;">(Employee Confirms Acceptance)</span></h2>
    <div style="border: 1px solid #ccc; padding: 15px; font-size: 0.9em; line-height: 1.6; border-radius: 6px; background-color: #fdfdfd;">
        
        <h3 style="margin-top: 0; font-size: 1em;">1. Resource Custody and Maintenance</h3>
        <ul class="acknowledgement-list">
            <li><strong>Custody and Responsibility:</strong> The Employee is assigned custody of the specified Chesmi Group IT resources (e.g., laptop, peripherals) and accepts full responsibility for their proper handling and security.</li>
            <li><strong>Maintenance and Care:</strong> The Employee shall be responsible for the day-to-day care and maintenance of the assigned resources, strictly adhering to the procedures and technical guidance provided by the IT Division.</li>
        </ul>
        
        <h3 style="margin-top: 15px; font-size: 1em;">2. Reporting and Damage Liability</h3>
        <ul class="acknowledgement-list">
            <li><strong>Reporting Requirements:</strong> Any damage, malfunction, required repair, or loss of the assigned IT resources must be <strong>immediately reported</strong> to the IT Division. This report must be submitted via official email and include prior approval from the immediate Reporting Head and/or Manager. The physical device must be submitted for official investigation, if required.</li>
            <li><strong>Liability for Damages:</strong> The Employee acknowledges and accepts <strong>full financial and operational liability</strong> for any physical damage, loss, or deterioration caused to the assigned IT resources that results from negligence, misuse, or failure to follow IT policy.</li>
        </ul>

        <h3 style="margin-top: 15px; font-size: 1em;">3. Usage Policy and Compliance</h3>
        <ul class="acknowledgement-list">
            <li><strong>Authorized Use Only:</strong> Chesmi Group IT resources are provided strictly for <strong>official use and authorized business purposes</strong> related to assigned duties. Personal use that interferes with assigned duties or violates company policy is prohibited.</li>
            <li><strong>Legal Compliance:</strong> The Employee guarantees that the use of these resources will not, in any circumstance, violate any applicable internal policies, local regulations, or the laws of the Democratic Socialist Republic of Sri Lanka.</li>
            <li><strong>Training Mandate:</strong> The Employee shall complete all required user training, including, but not limited to, information security and data handling, upon initial assignment and <strong>annually thereafter</strong>, or as directed by management.</li>
        </ul>
    </div>

    <div class="signature-block">
        <div class="signature-field">
            <div class="signature-line"></div>
            <p class="signature-label">Employee Signature</p>
        </div>
        <div class="signature-field">
            <div class="input-container"><input type="date" id="ackDateInput"></div>
            <p class="signature-label">Date</p>
        </div>
    </div>
    
    <hr style="margin-top: 30px; border-top: 1px solid #e0e0e0;">

    <h2>Laptop Condition Checklist <span style="font-weight:400; font-size: 0.8em;">(IT Department Use)</span></h2>

    <h3 style="margin-top: 15px;">1. Physical Inspection <span style="font-weight:400; font-size: 0.8em;">(Check if in working condition/good state)</span></h3>
    <table class="checklist-table">
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Lid / Hinges Condition (Check for gaps or damage)</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Screen (Check for scratches, cracks, or disfigurement)</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Keyboard/Keys (All present and functional)</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Laptop Bag (Condition Check - If applicable)</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Power Adaptor/Charger (No damage to wire or head)</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>General Exterior / Body Condition (Check for major scuffs or dents)</td></tr>
    </table>
    
    <div class="form-group" style="display: block; margin-top: 15px;">
        <label for="conditionNotes" style="width: auto; font-weight: 600;">Description of any Scratches/Marks/Damage Found:</label>
        <textarea id="conditionNotes" rows="2" style="width: 100%;" placeholder="Enter details of any pre-existing permanent damage or marks."></textarea>
    </div>

    <h3 style="margin-top: 25px;">2. Functional Inspection <span style="font-weight:400; font-size: 0.8em;">(Check if working)</span></h3>
    <table class="checklist-table">
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Display Brightness / No dead pixels</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>All keys and Trackpad/Mouse are working</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Wireless/Wi-Fi connectivity & Bluetooth</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Battery Health (Charged and holding charge)</td></tr>
        <tr><td style="width: 50px;"><input type="checkbox"></td><td>Operating System License/Activation & Required Software (e.g., Antivirus)</td></tr>
    </table>

    <p style="margin-top: 20px; font-style: italic;">I confirm that I have physically inspected and functionally tested the device. Unless otherwise noted above, all items were found to be in good working condition.</p>

    <div class="signature-block">
        <div class="signature-field">
            <div class="signature-line"></div>
            <p class="signature-label">Tech Support Signature</p>
        </div>
        <div class="signature-field">
            <div class="input-container"><input type="text" placeholder="Tech Support Name (Print)" id="techNameInput"></div>
            <p class="signature-label">Tech Support Name</p>
        </div>
        <div class="signature-field">
            <div class="input-container"><input type="date" id="techDateInput"></div>
            <p class="signature-label">Date</p>
        </div>
    </div>
</form>

<div class="form-actions no-print">
    <button type="button" id="downloadPdfBtn">ðŸ’¾ Download as PDF</button>
    <button type="button" id="shareEmailBtn" class="email-btn">ðŸ“§ Share via Email</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
    window.onload = function () {
        const downloadBtn = document.getElementById('downloadPdfBtn');
        const shareBtn = document.getElementById('shareEmailBtn');

        downloadBtn.addEventListener('click', () => generatePdf('Chesmi-Laptop-Acknowledgement.pdf'));
        shareBtn.addEventListener('click', () => shareViaEmail('Laptop Acknowledgement'));

        async function generatePdf(fileName) {
            const { jsPDF } = window.jspdf;
            const formToCapture = document.querySelector('.a4-page');

            document.body.classList.add('pdf-snapshot');
            
            const canvas = await html2canvas(formToCapture, {
                scale: 2,
                useCORS: true,
                logging: false
            });
            
            document.body.classList.remove('pdf-snapshot');

            const imgData = canvas.toDataURL('image/png');
            const pdf = new jsPDF('p', 'mm', 'a4');
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = pdf.internal.pageSize.getHeight();
            
            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            pdf.save(fileName);
        }

        function shareViaEmail(formType) {
            const employeeName = document.getElementById('employeeName').value || 'Employee';
            const subject = `${formType} signed by ${employeeName}`;
            const body = `Dear Team,\n\nPlease find the signed ${formType} attached for your records.\n\nThis is a client-generated request. Please download the PDF from the form and attach it to this email before sending.\n\nThank you,\n${employeeName}`;
            
            window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        }
    };
</script>
</body>
</html>
